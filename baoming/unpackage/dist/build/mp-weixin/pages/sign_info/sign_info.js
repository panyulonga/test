(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/sign_info/sign_info"],{"4c25":function(t,i,o){"use strict";o.r(i);var e=o("c7d0"),n=o("6c56");for(var a in n)"default"!==a&&function(t){o.d(i,t,(function(){return n[t]}))}(a);o("cff7");var s,d=o("f0c5"),c=Object(d["a"])(n["default"],e["b"],e["c"],!1,null,null,null,!1,e["a"],s);i["default"]=c.exports},"6c56":function(t,i,o){"use strict";o.r(i);var e=o("892d"),n=o.n(e);for(var a in e)"default"!==a&&function(t){o.d(i,t,(function(){return e[t]}))}(a);i["default"]=n.a},"892d":function(t,i,o){"use strict";(function(t){Object.defineProperty(i,"__esModule",{value:!0}),i.default=void 0;var e=n(o("95d2"));function n(t){return t&&t.__esModule?t:{default:t}}var a={data:function(){return{curRoutes:"",infoList:"",works:"",briefs:"",link:"",account_name:"",account_id:"",fillinAppId:"",xcx_src:"",array:["图文赛区","视频赛区","小程序赛区"],num:0,list_img:{path:"",id:""},list_img2:{path:"",id:""},list_img3:{path:"",id:""},src:{path:"",id:""},showVideo:!1,addVideo:!0,info_data:{},personInfo:{openid:"",method:"",type:"article",token:""},sign_info:{},imgList:[],imgIdList:[],numType:"",typeBl:!1,mask:!0,btmText:"提交作品",btmText2:"",top_background:"background:none;color:#fff;",top_background_imgurl:"../../static/assets/arrow-left-bold1.png",top_style:"",top_height:"",url:""}},onLoad:function(i){var o=this,n=t.getMenuButtonBoundingClientRect(),a=(n.height-40)/2;this.top_height="height:"+(n.top+a)+"px",this.top_style="top:"+(n.top+a)+"px";var s=getCurrentPages(),d=s[s.length-1].route;this.curRoutes=d,t.request({url:e.default.WEBSITE_URL+"/api/competition/getConfig",success:function(t){0==t.data.code&&(o.infoList=t.data.data)}}),this.personInfo.token=t.getStorageSync("names","data").token,""==this.personInfo.token&&t.navigateTo({url:"../login/login"}),console.log(i),i.type&&(this.mask=!1,this.articleDetails(i.type))},onShareAppMessage:function(t){return{title:this.infoList.share_title,path:this.curRoutes,imageUrl:this.infoList.share_cover}},onShareTimeline:function(t){return{title:this.infoList.share_title,path:this.curRoutes,imageUrl:this.infoList.share_cover}},methods:{maskClick:function(){console.log(123123),this.mask=!0},articleDetails:function(i){var o=this;this.works="",this.briefs="",this.link="",this.account_name="",this.account_id="",this.fillinAppId="",this.xcx_src="",this.src.path="",this.list_img.path="",this.list_img2.path="",this.list_img3.path="",this.personInfo.type=i,this.mask=!1,console.log(15151),t.request({url:e.default.WEBSITE_URL+"/api/competition/getAllSubmission?token="+this.personInfo.token+"&channel="+e.default.CHANNEL+"&type="+this.personInfo.type,success:function(i){console.log(i.data),console.log(o.personInfo.type,"-----",t.getStorageSync("type","data")),o.personInfo.type==t.getStorageSync("type","data")?o.btmText="修改作品":o.btmText="提交作品",i.data.data[o.personInfo.type][0]?(o.personInfo.method="update",o.numType=i.data.data[o.personInfo.type][0].type,o.typeBl=!0,o.works=i.data.data[o.personInfo.type][0].name,o.briefs=i.data.data[o.personInfo.type][0].description,o.link=i.data.data[o.personInfo.type][0].url,o.account_name=i.data.data[o.personInfo.type][0].account_name,o.account_id=i.data.data[o.personInfo.type][0].account_id,o.fillinAppId=i.data.data[o.personInfo.type][0].appid,o.xcx_src=i.data.data[o.personInfo.type][0].path,o.list_img.path=[i.data.data[o.personInfo.type][0].cover],o.list_img2.path=[i.data.data[o.personInfo.type][0].qrcode],o.list_img3.path=[i.data.data[o.personInfo.type][0].statement],o.src.path=i.data.data[o.personInfo.type][0].video):o.personInfo.method="create","article"==o.personInfo.type?o.num=0:"video"==o.personInfo.type?o.num=1:"miniapp"==o.personInfo.type&&(o.num=2),2==parseInt(i.data.data[o.personInfo.type][0].audit_status)?t.showModal({title:"已审核",content:"您的作品已通过审核！",showCancel:!1}):-1==parseInt(i.data.data[o.personInfo.type][0].audit_status)?(console.log(i.data.data[o.personInfo.type][0].audit_status),t.showModal({title:"未通过",content:"原因："+i.data.data[o.personInfo.type][0].reject_reason+"。请修改后重新提交",showCancel:!1})):0==parseInt(i.data.data[o.personInfo.type][0].audit_status)?t.showModal({title:"待审核",content:"您的作品已提交",showCancel:!1}):1==parseInt(i.data.data[o.personInfo.type][0].audit_status)&&t.showModal({title:"待审核",content:"您的作品正在转码",showCancel:!1})}})},unloadInfo:function(){if(console.log(this.list_img3),""==this.list_img3.path)return console.log("jinlail"),void t.showToast({icon:"none",title:"请把信息填写完整"});"update"==this.personInfo.method&&""===this.list_img3.id||(this.info_data.statement=this.list_img3.id),"update"==this.personInfo.method&&""===this.list_img.id?console.log("我进来啦"):this.info_data.cover=this.list_img.id,this.personInfo.type=0==this.num?"article":1==this.num?"video":"miniapp",this.info_data.name=this.works,this.info_data.description=this.briefs,0==this.num?""==this.works||""==this.briefs||""==this.link||""==this.list_img.path||""==this.list_img2.path||""==this.account_name||""==this.account_id?t.showToast({icon:"none",title:"请把信息填写完整"}):("update"==this.personInfo.method&&""===this.list_img2.id||(this.info_data.qrcode=this.list_img2.id),this.info_data.url=this.link,this.info_data.account_name=this.account_name,this.info_data.account_id=this.account_id,this.submitInfo()):1==this.num?""==this.works||""==this.briefs||""==this.src.path||""==this.list_img.path?(t.showToast({icon:"none",title:"请把信息填写完整"}),console.log(this.src.path,this.list_img2.path)):("update"==this.personInfo.method&&""===this.src.id||(this.info_data.video=this.src.id),this.submitInfo()):2==this.num&&(""==this.works||""==this.briefs||""==this.fillinAppId||""==this.list_img.path||""==this.xcx_src||""==this.list_img2.path?t.showToast({icon:"none",title:"请把信息填写完整"}):("update"==this.personInfo.method&&""===this.list_img2.id||(this.info_data.qrcode=this.list_img2.id),this.info_data.appid=this.fillinAppId,this.info_data.path=this.xcx_src,this.submitInfo()))},submitInfo:function(){var i=this;console.log(this.info_data);var o=this.info_data;t.request({method:"POST",url:e.default.WEBSITE_URL+"/api/competition/submission?token="+this.personInfo.token+"&channel="+e.default.CHANNEL+"&method="+this.personInfo.method+"&type="+this.personInfo.type,data:o,success:function(o){console.log(o.data,"-----",i.info_data),0==o.data.code?(t.setStorageSync("type",i.personInfo.type),t.showModal({title:i.typeBl?"修改成功":"提交成功",showCancel:!1,success:function(){t.navigateTo({url:"/pages/sign_up/sign_up"})}})):t.showToast({icon:"none",title:o.data.msg})}})},del_img:function(t,i){0==t?this.list_img.path="":1==t?this.list_img2.path="":2==t&&(this.list_img3.path="")},bindPickerChange:function(t){this.num=t.target.value,this.jg=this.array[this.num]},indexJump:function(i){t.navigateTo({url:"/pages/".concat(i,"/").concat(i)})},imreturn:function(){t.navigateBack()},addVideoFun:function(){var i=this;t.chooseVideo({count:1,success:function(o){t.showLoading({title:"视频上传中"}),console.log(o),o.size>e.default.MAXVIDEO&&t.showModal({title:"错误",content:"上传失败,超过500M",showCancel:!1}),t.uploadFile({url:e.default.WEBSITE_URL+"/api/api/multimediaUpload?channel="+e.default.CHANNEL+"&token="+i.personInfo.token+"&key=video&module=member_video&type=video",filePath:o.tempFilePath,name:"video",header:{Authorization:"Bearer "+t.getStorageSync("access")},success:function(o){t.hideLoading();var e=JSON.parse(o.data);console.log(e),0==e.code?(t.hideLoading(),i.src.path=e.data.url,i.src.id=e.data.file_id,console.log(i.src)):t.showModal({title:"错误",content:"上传失败",showCancel:!1})}})}})},delImg:function(){this.src.path=""},uploadImg:function(i,o){var n=this;t.chooseImage({count:1,success:function(a){t.showLoading({title:"图片上传中"}),a.size>e.default.MAXIMAGE&&t.showModal({title:"错误",content:"上传失败,超过10M",showCancel:!1}),a.tempFilePaths.forEach((function(a){t.uploadFile({url:e.default.WEBSITE_URL+"/api/api/multimediaUpload?channel="+e.default.CHANNEL+"&token="+n.personInfo.token+"&key="+i+"&module="+o+"&type=image",filePath:a,name:i,success:function(i){if(i.data)try{console.log(i.data);var e=JSON.parse(i.data);console.log(e),0!=e.code?(t.showModal({title:"错误",content:"上传失败",showCancel:!1}),t.hideLoading()):(console.log("进来了"),t.hideLoading(),"member_cover"==o?(n.list_img.path=e.data.url,n.list_img.id=e.data.file_id):"member_qrcode"==o?(n.list_img2.path=e.data.url,n.list_img2.id=e.data.file_id):"member_statement"==o&&(n.list_img3.path=e.data.url,n.list_img3.id=e.data.file_id.toString()))}catch(a){t.showModal({title:"错误",content:"上传失败",showCancel:!1}),t.hideLoading()}}})}))}})},returnHome:function(){t.reLaunch({url:"../index/index"})},onPageScroll:function(t){var i=t.scrollTop;i<=10?(this.top_background="background:none;color:#fff;",this.top_background_imgurl="../../static/assets/arrow-left-bold1.png"):(this.top_background="background:rgba(255,255,255,1);color:#333;",this.top_background_imgurl="../../static/assets/arrow-left-bold.png")}}};i.default=a}).call(this,o("543d")["default"])},a372:function(t,i,o){},bf8c:function(t,i,o){"use strict";(function(t){o("9f11");e(o("66fd"));var i=e(o("4c25"));function e(t){return t&&t.__esModule?t:{default:t}}t(i.default)}).call(this,o("543d")["createPage"])},c7d0:function(t,i,o){"use strict";var e;o.d(i,"b",(function(){return n})),o.d(i,"c",(function(){return a})),o.d(i,"a",(function(){return e}));var n=function(){var t=this,i=t.$createElement;t._self._c},a=[]},cff7:function(t,i,o){"use strict";var e=o("a372"),n=o.n(e);n.a}},[["bf8c","common/runtime","common/vendor"]]]);